<!--
RULES
* Never place a link to an external site like Google Doc. The proposal should be in this issue entirely.
* Use a spelling and grammar checker tools if available for you (there are plenty of free ones).

PROPOSAL HEALTH CHECK
I can read the design document and understand the problem statement and what you plan to change *without* resorting to a couple of hours of code reading just to start having a high level understanding of the change.

IMAGES
If you need diagrams, avoid attaching large files. You can use [MermaidJS]([url](https://mermaid.js.org/)) as a simple language to describe many types of diagrams.

THIS COMMENTS
Please remove them when done.
-->

# PIP-332: Peek messages from topic subscription with offset

# Background knowledge

<!--
Describes all the knowledge you need to know in order to understand all the other sections in this PIP

* Give a high level explanation on all concepts you will be using throughout this document. For example, if you want to talk about Persistent Subscriptions, explain briefly (1 paragraph) what this is. If you're going to talk about Transaction Buffer, explain briefly what this is. 
  If you're going to change something specific, then go into more detail about it and how it works. 
* Provide links where possible if a person wants to dig deeper into the background information. 

DON'T
* Do not include links *instead* explanation. Do provide links for further explanation.

EXAMPLES
* See [PIP-248](https://github.com/apache/pulsar/issues/19601), Background section to get an understanding on how you add the background knowledge needed.
  (They also included the motivation there, but ignore it as we place that in Motivation section explicitly).
-->
In Pulsar, a subscription maintains a state of message acknowledged. A subscription backlog is the set of messages which are unacknowledged.

A subscription backlog size is the sum of size of unacknowledged messages(in bytes).

A topic can have many subscriptions.

Messages on that subscription backlog can be viewed without acknowledging them. This is called peeking of messages.

Pagination is a UI pattern that splits content into separate pages. It's usually represented by a row of numbers that sits at the top and/or bottom of a page and contains controls allowing to switch between pages and go to the first/last pages.
# Motivation

<!--
Describe the problem this proposal is trying to solve.

* Explain what is the problem you're trying to solve - current situation.
* This section is the "Why" of your proposal.
-->
Currently we are able to peek any number of messages using the Pulsar Java Admin API.

However, we are only able to view these messages starting from the most recent message. If we want to view the 100th message, we have to peek all the top 100 messages.

We want to display these messages on our UI in a table. When the number of messages to be viewed is large, we want to split them by page and display them on the UI. So, we would like the ability to view any batch of messages instead of all of the top messages.

# Goals

Peek messages from a topic subscription with a offset value.

So, if you want to display the 90-100 message on the 10th page in the UI, you can set the offset value to 90 and then peek the next 10 messages to get the 90-100 messages.

## Design & Implementation Details

<!--
This is the section where you dive into the details. It can be:
* Concrete class names and their roles and responsibility, including methods.
* Code snippets of existing code.
* Interface names and its methods.
* ...
-->

The Pulsar Admin API in Java currently provides a way to peek messages using this `https://pulsar.apache.org/docs/3.1.x/admin-api-topics/#peek-messages`

This function includes a default hardcoded offset value of 1. We want to give the user the option to input a different offset value.

# Backward & Forward Compatibility

The current `peekMessages(String topic, String subName, int numMessages)` method will remain the same and use offset 1.

We will be overloading this method with `offset`. It will default to 1 if not specified.

# Links

<!--
Updated afterwards
-->
* Mailing List discussion thread:
* Mailing List voting thread: