<!doctype html>
<html class="docs-version-current" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.6">
<link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Apache Pulsar Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Apache Pulsar Blog Atom Feed"><title data-react-helmet="true">Pulsar C++ client | Apache Pulsar</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://pulsar.apache.com/docs/next/client-libraries-cpp"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Pulsar C++ client | Apache Pulsar"><meta data-react-helmet="true" name="description" content="You can use Pulsar C++ client to create Pulsar producers and consumers in C++."><meta data-react-helmet="true" property="og:description" content="You can use Pulsar C++ client to create Pulsar producers and consumers in C++."><link data-react-helmet="true" rel="shortcut icon" href="/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://pulsar.apache.com/docs/next/client-libraries-cpp"><link data-react-helmet="true" rel="alternate" href="https://pulsar.apache.com/docs/next/client-libraries-cpp" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://pulsar.apache.com/docs/next/client-libraries-cpp" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.4a6b6be2.css">
<link rel="preload" href="/assets/js/runtime~main.668ae9d7.js" as="script">
<link rel="preload" href="/assets/js/main.3d3de418.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_1oUP">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><img src="/img/logo.svg" alt="Apache Pulsar" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/img/logo.svg" alt="Apache Pulsar" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><b class="navbar__title"></b></a><a class="navbar__item navbar__link navbar__link--active" href="/docs/next/">Docs</a><a class="navbar__item navbar__link" href="/versions">Versions</a><a class="navbar__item navbar__link" href="/blog">Blog</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/apache/pulsar" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a aria-current="page" class="navbar__link" href="/docs">Version</a><ul class="dropdown__menu"><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/docs/">2.8.0</a></li><li><a class="dropdown__link" href="/docs/2.7.3/">2.7.3</a></li><li><a class="dropdown__link" href="/docs/2.7.2/">2.7.2</a></li><li><a class="dropdown__link" href="/docs/2.7.1/">2.7.1</a></li><li><a class="dropdown__link" href="/docs/2.7.0/">2.7.0</a></li><li><a class="dropdown__link" href="/docs/2.6.4/">2.6.4</a></li><li><a class="dropdown__link" href="/docs/2.6.3/">2.6.3</a></li><li><a class="dropdown__link" href="/docs/2.6.2/">2.6.2</a></li><li><a class="dropdown__link" href="/docs/2.2.0/">2.2.0</a></li></ul></div><div class="react-toggle toggle_3Zt9 react-toggle--disabled"><div class="react-toggle-track" role="button" tabindex="-1"><div class="react-toggle-track-check"><span class="toggle_71bT">ðŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_71bT">ðŸŒž</span></div><div class="react-toggle-thumb"></div></div><input type="checkbox" class="react-toggle-screenreader-only" aria-label="Switch between dark and light mode"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_31aa"><button class="clean-btn backToTopButton_35hR" type="button"><svg viewBox="0 0 24 24" width="28"><path d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z" fill="currentColor"></path></svg></button><aside class="docSidebarContainer_3Kbt"><div class="sidebar_15mo"><nav class="menu thin-scrollbar menu_Bmed menuWithAnnouncementBar_2WvA"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Get Started</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Concepts and Architecture</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Pulsar Schema</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Pulsar Functions</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Pulsar IO</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Pulsar SQL</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Tiered Storage</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Transactions</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Kubernetes (Helm)</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Deployment</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Administration</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Security</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Performance</a></li><li class="theme-doc-sidebar-item-category menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#">Client Libraries</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/docs/next/client-libraries">Overview</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/docs/next/client-libraries-java">Java</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/docs/next/client-libraries-go">Go</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/docs/next/client-libraries-python">Python</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/next/client-libraries-cpp">C++</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/docs/next/client-libraries-node">Node.js</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/docs/next/client-libraries-websocket">WebSocket</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/docs/next/client-libraries-dotnet">C#</a></li></ul></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Admin API</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Adaptors</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Cookbooks</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Development</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Reference</a></li></ul></nav></div></aside><main class="docMainContainer_3ufF"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_3FnS"><div class="theme-doc-version-banner alert alert--warning margin-bottom--md" role="alert"><div>This is unreleased documentation for Apache Pulsar <b>Next</b> version.</div><div class="margin-top--md">For up-to-date documentation, see the <b><a href="/docs/client-libraries-cpp">latest version</a></b> (2.8.0).</div></div><div class="docItemContainer_33ec"><article><span class="theme-doc-version-badge badge badge--secondary">Version: Next</span><div class="tocCollapsible_1PrD theme-doc-toc-mobile tocMobile_3Hoh"><button type="button" class="clean-btn tocCollapsibleButton_2O1e">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Pulsar C++ client</h1></header><p>You can use Pulsar C++ client to create Pulsar producers and consumers in C++.</p><p>All the methods in producer, consumer, and reader of a C++ client are thread-safe.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="supported-platforms"></a>Supported platforms<a class="hash-link" href="#supported-platforms" title="Direct link to heading">#</a></h2><p>Pulsar C++ client is supported on <strong>Linux</strong> ,<strong>MacOS</strong> and <strong>Windows</strong> platforms.</p><p><a href="http://www.doxygen.nl/" target="_blank" rel="noopener noreferrer">Doxygen</a>-generated API docs for the C++ client are available <a href="/api/cpp/2.8.0-SNAPSHOT">here</a>.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="system-requirements"></a>System requirements<a class="hash-link" href="#system-requirements" title="Direct link to heading">#</a></h2><p>You need to install the following components before using the C++ client:</p><ul><li><a href="https://cmake.org/" target="_blank" rel="noopener noreferrer">CMake</a></li><li><a href="http://www.boost.org/" target="_blank" rel="noopener noreferrer">Boost</a></li><li><a href="https://developers.google.com/protocol-buffers/" target="_blank" rel="noopener noreferrer">Protocol Buffers</a> &gt;= 3</li><li><a href="https://curl.se/libcurl/" target="_blank" rel="noopener noreferrer">libcurl</a></li><li><a href="https://github.com/google/googletest" target="_blank" rel="noopener noreferrer">Google Test</a></li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="linux"></a>Linux<a class="hash-link" href="#linux" title="Direct link to heading">#</a></h2><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="compilation"></a>Compilation<a class="hash-link" href="#compilation" title="Direct link to heading">#</a></h3><ol><li>Clone the Pulsar repository.</li></ol><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly shell"><pre tabindex="0" class="prism-code language-shell codeBlock_23N8 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ </span><span class="token function" style="color:rgb(80, 250, 123)">git</span><span class="token plain"> clone https://github.com/apache/pulsar</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><ol start="2"><li>Install all necessary dependencies.</li></ol><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly shell"><pre tabindex="0" class="prism-code language-shell codeBlock_23N8 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ </span><span class="token function" style="color:rgb(80, 250, 123)">apt-get</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">install</span><span class="token plain"> cmake libssl-dev libcurl4-openssl-dev liblog4cxx-dev </span><span class="token punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  libprotobuf-dev protobuf-compiler libboost-all-dev google-mock libgtest-dev libjsoncpp-dev</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><ol start="3"><li>Compile and install <a href="https://github.com/google/googletest" target="_blank" rel="noopener noreferrer">Google Test</a>.</li></ol><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly shell"><pre tabindex="0" class="prism-code language-shell codeBlock_23N8 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># libgtest-dev version is 1.18.0 or above</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">cd</span><span class="token plain"> /usr/src/googletest</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ </span><span class="token function" style="color:rgb(80, 250, 123)">sudo</span><span class="token plain"> cmake </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">.</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ </span><span class="token function" style="color:rgb(80, 250, 123)">sudo</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">make</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ </span><span class="token function" style="color:rgb(80, 250, 123)">sudo</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">cp</span><span class="token plain"> ./googlemock/libgmock.a ./googlemock/gtest/libgtest.a /usr/lib/</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># less than 1.18.0</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">cd</span><span class="token plain"> /usr/src/gtest</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ </span><span class="token function" style="color:rgb(80, 250, 123)">sudo</span><span class="token plain"> cmake </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">.</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ </span><span class="token function" style="color:rgb(80, 250, 123)">sudo</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">make</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ </span><span class="token function" style="color:rgb(80, 250, 123)">sudo</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">cp</span><span class="token plain"> libgtest.a /usr/lib</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">cd</span><span class="token plain"> /usr/src/gmock</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ </span><span class="token function" style="color:rgb(80, 250, 123)">sudo</span><span class="token plain"> cmake </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">.</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ </span><span class="token function" style="color:rgb(80, 250, 123)">sudo</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">make</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ </span><span class="token function" style="color:rgb(80, 250, 123)">sudo</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">cp</span><span class="token plain"> libgmock.a /usr/lib</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><ol start="4"><li>Compile the Pulsar client library for C++ inside the Pulsar repository.</li></ol><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly shell"><pre tabindex="0" class="prism-code language-shell codeBlock_23N8 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">cd</span><span class="token plain"> pulsar-client-cpp</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ cmake </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">.</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ </span><span class="token function" style="color:rgb(80, 250, 123)">make</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>After you install the components successfully, the files <code>libpulsar.so</code> and <code>libpulsar.a</code> are in the <code>lib</code> folder of the repository. The tools <code>perfProducer</code> and <code>perfConsumer</code> are in the <code>perf</code> directory.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="install-dependencies"></a>Install Dependencies<a class="hash-link" href="#install-dependencies" title="Direct link to heading">#</a></h3><blockquote><p>Since 2.1.0 release, Pulsar ships pre-built RPM and Debian packages. You can download and install those packages directly.</p></blockquote><p>After you download and install RPM or DEB, the <code>libpulsar.so</code>, <code>libpulsarnossl.so</code>, <code>libpulsar.a</code>, and <code>libpulsarwithdeps.a</code> libraries are in your <code>/usr/lib</code> directory.</p><p>By default, they are built in code path <code>${PULSAR_HOME}/pulsar-client-cpp</code>. You can build with the command below.</p><p> <code>cmake . -DBUILD_TESTS=OFF -DLINK_STATIC=ON &amp;&amp; make pulsarShared pulsarSharedNossl pulsarStatic pulsarStaticWithDeps -j 3</code>.</p><p>These libraries rely on some other libraries. If you want to get detailed version of dependencies, see <a href="https://github.com/apache/pulsar/blob/master/pulsar-client-cpp/pkg/rpm/Dockerfile" target="_blank" rel="noopener noreferrer">RPM</a> or <a href="https://github.com/apache/pulsar/blob/master/pulsar-client-cpp/pkg/deb/Dockerfile" target="_blank" rel="noopener noreferrer">DEB</a> files.</p><ol><li><code>libpulsar.so</code> is a shared library, containing statically linked <code>boost</code> and <code>openssl</code>. It also dynamically links all other necessary libraries. You can use this Pulsar library with the command below.</li></ol><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> g++ --std</span><span class="token operator">=</span><span class="token plain">c++11  PulsarTest.cpp -o </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">test</span><span class="token plain"> /usr/lib/libpulsar.so -I/usr/local/ssl/include</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><ol start="2"><li><code>libpulsarnossl.so</code> is a shared library, similar to <code>libpulsar.so</code> except that the libraries <code>openssl</code> and <code>crypto</code> are dynamically linked. You can use this Pulsar library with the command below.</li></ol><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> g++ --std</span><span class="token operator">=</span><span class="token plain">c++11  PulsarTest.cpp -o </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">test</span><span class="token plain"> /usr/lib/libpulsarnossl.so -lssl -lcrypto -I/usr/local/ssl/include -L/usr/local/ssl/lib</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><ol start="3"><li><code>libpulsar.a</code> is a static library. You need to load dependencies before using this library. You can use this Pulsar library with the command below.</li></ol><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> g++ --std</span><span class="token operator">=</span><span class="token plain">c++11  PulsarTest.cpp -o </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">test</span><span class="token plain"> /usr/lib/libpulsar.a -lssl -lcrypto -ldl -lpthread  -I/usr/local/ssl/include -L/usr/local/ssl/lib -lboost_system -lboost_regex -lcurl -lprotobuf -lzstd -lz</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><ol start="4"><li><code>libpulsarwithdeps.a</code> is a static library, based on <code>libpulsar.a</code>. It is archived in the dependencies of <code>libboost_regex</code>, <code>libboost_system</code>, <code>libcurl</code>, <code>libprotobuf</code>, <code>libzstd</code> and <code>libz</code>. You can use this Pulsar library with the command below.</li></ol><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> g++ --std</span><span class="token operator">=</span><span class="token plain">c++11  PulsarTest.cpp -o </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">test</span><span class="token plain"> /usr/lib/libpulsarwithdeps.a -lssl -lcrypto -ldl -lpthread  -I/usr/local/ssl/include -L/usr/local/ssl/lib</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>The <code>libpulsarwithdeps.a</code> does not include library openssl related libraries <code>libssl</code> and <code>libcrypto</code>, because these two libraries are related to security. It is more reasonable and easier to use the versions provided by the local system to handle security issues and upgrade libraries.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="install-rpm"></a>Install RPM<a class="hash-link" href="#install-rpm" title="Direct link to heading">#</a></h3><ol><li>Download a RPM package from the links in the table. </li></ol><table><thead><tr><th>Link</th><th>Crypto files</th></tr></thead><tbody><tr><td><a href="https://archive.apache.org/dist/pulsar/pulsar-2.8.0/RPMS/apache-pulsar-client-2.8.0-1.x86_64.rpm" target="_blank" rel="noopener noreferrer">client</a></td><td><a href="https://archive.apache.org/dist/pulsar/pulsar-2.8.0/RPMS/apache-pulsar-client-2.8.0-1.x86_64.rpm.asc" target="_blank" rel="noopener noreferrer">asc</a>, <a href="https://archive.apache.org/dist/pulsar/pulsar-2.8.0/RPMS/apache-pulsar-client-2.8.0-1.x86_64.rpm.sha512" target="_blank" rel="noopener noreferrer">sha512</a></td></tr><tr><td><a href="https://archive.apache.org/dist/pulsar/pulsar-2.8.0/RPMS/apache-pulsar-client-debuginfo-2.8.0-1.x86_64.rpm" target="_blank" rel="noopener noreferrer">client-debuginfo</a></td><td><a href="https://archive.apache.org/dist/pulsar/pulsar-2.8.0/RPMS/apache-pulsar-client-debuginfo-2.8.0-1.x86_64.rpm.asc" target="_blank" rel="noopener noreferrer">asc</a>,  <a href="https://archive.apache.org/dist/pulsar/pulsar-2.8.0/RPMS/apache-pulsar-client-debuginfo-2.8.0-1.x86_64.rpm.sha512" target="_blank" rel="noopener noreferrer">sha512</a></td></tr><tr><td><a href="https://archive.apache.org/dist/pulsar/pulsar-2.8.0/RPMS/apache-pulsar-client-devel-2.8.0-1.x86_64.rpm" target="_blank" rel="noopener noreferrer">client-devel</a></td><td><a href="https://archive.apache.org/dist/pulsar/pulsar-2.8.0/RPMS/apache-pulsar-client-devel-2.8.0-1.x86_64.rpm.asc" target="_blank" rel="noopener noreferrer">asc</a>,  <a href="https://archive.apache.org/dist/pulsar/pulsar-2.8.0/RPMS/apache-pulsar-client-devel-2.8.0-1.x86_64.rpm.sha512" target="_blank" rel="noopener noreferrer">sha512</a></td></tr></tbody></table><ol start="2"><li>Install the package using the following command.</li></ol><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ </span><span class="token function" style="color:rgb(80, 250, 123)">rpm</span><span class="token plain"> -ivh apache-pulsar-client*.rpm</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>After you install RPM successfully, Pulsar libraries are in the <code>/usr/lib</code> directory.</p><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</h5></div><div class="admonition-content"><p>If you get the error that <code>libpulsar.so: cannot open shared object file: No such file or directory</code> when starting Pulsar client, you may need to run <code>ldconfig</code> first.</p></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="install-debian"></a>Install Debian<a class="hash-link" href="#install-debian" title="Direct link to heading">#</a></h3><ol><li>Download a Debian package from the links in the table. </li></ol><table><thead><tr><th>Link</th><th>Crypto files</th></tr></thead><tbody><tr><td><a href="https://www.apache.org/dyn/mirrors/mirrors.cgi?action=download&amp;filename=pulsar/pulsar-2.8.0/DEB/apache-pulsar-client.deb" target="_blank" rel="noopener noreferrer">client</a></td><td><a href="https://archive.apache.org/dist/pulsar/pulsar-2.8.0/DEB/apache-pulsar-client.deb.asc" target="_blank" rel="noopener noreferrer">asc</a>, <a href="https://archive.apache.org/dist/pulsar/pulsar-2.8.0/DEB/apache-pulsar-client.deb.sha512" target="_blank" rel="noopener noreferrer">sha512</a></td></tr><tr><td><a href="https://www.apache.org/dyn/mirrors/mirrors.cgi?action=download&amp;filename=pulsar/pulsar-2.8.0/DEB/apache-pulsar-client-dev.deb" target="_blank" rel="noopener noreferrer">client-devel</a></td><td><a href="https://archive.apache.org/dist/pulsar/pulsar-2.8.0/DEB/apache-pulsar-client-dev.deb.asc" target="_blank" rel="noopener noreferrer">asc</a>,  <a href="https://archive.apache.org/dist/pulsar/pulsar-2.8.0/DEB/apache-pulsar-client-dev.deb.sha512" target="_blank" rel="noopener noreferrer">sha512</a></td></tr></tbody></table><ol start="2"><li>Install the package using the following command.</li></ol><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ </span><span class="token function" style="color:rgb(80, 250, 123)">apt</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">install</span><span class="token plain"> ./apache-pulsar-client*.deb</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>After you install DEB successfully, Pulsar libraries are in the <code>/usr/lib</code> directory.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="build"></a>Build<a class="hash-link" href="#build" title="Direct link to heading">#</a></h3><blockquote><p>If you want to build RPM and Debian packages from the latest master, follow the instructions below. You should run all the instructions at the root directory of your cloned Pulsar repository.</p></blockquote><p>There are recipes that build RPM and Debian packages containing a
statically linked <code>libpulsar.so</code> / <code>libpulsarnossl.so</code> / <code>libpulsar.a</code> / <code>libpulsarwithdeps.a</code> with all required dependencies.</p><p>To build the C++ library packages, you need to build the Java packages first.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly shell"><pre tabindex="0" class="prism-code language-shell codeBlock_23N8 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">mvn </span><span class="token function" style="color:rgb(80, 250, 123)">install</span><span class="token plain"> -DskipTests</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_31ik" id="rpm"></a>RPM<a class="hash-link" href="#rpm" title="Direct link to heading">#</a></h4><p>To build the RPM inside a Docker container, use the command below. The RPMs are in the <code>pulsar-client-cpp/pkg/rpm/RPMS/x86_64/</code> path.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly shell"><pre tabindex="0" class="prism-code language-shell codeBlock_23N8 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">pulsar-client-cpp/pkg/rpm/docker-build-rpm.sh</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><table><thead><tr><th>Package name</th><th>Content</th></tr></thead><tbody><tr><td>pulsar-client</td><td>Shared library <code>libpulsar.so</code> and <code>libpulsarnossl.so</code></td></tr><tr><td>pulsar-client-devel</td><td>Static library <code>libpulsar.a</code>, <code>libpulsarwithdeps.a</code>and C++ and C headers</td></tr><tr><td>pulsar-client-debuginfo</td><td>Debug symbols for <code>libpulsar.so</code></td></tr></tbody></table><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_31ik" id="debian"></a>Debian<a class="hash-link" href="#debian" title="Direct link to heading">#</a></h4><p>To build Debian packages, enter the following command.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly shell"><pre tabindex="0" class="prism-code language-shell codeBlock_23N8 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">pulsar-client-cpp/pkg/deb/docker-build-deb.sh</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>Debian packages are created in the <code>pulsar-client-cpp/pkg/deb/BUILD/DEB/</code> path.</p><table><thead><tr><th>Package name</th><th>Content</th></tr></thead><tbody><tr><td>pulsar-client</td><td>Shared library <code>libpulsar.so</code> and <code>libpulsarnossl.so</code></td></tr><tr><td>pulsar-client-dev</td><td>Static library <code>libpulsar.a</code>, <code>libpulsarwithdeps.a</code> and C++ and C headers</td></tr></tbody></table><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="macos"></a>MacOS<a class="hash-link" href="#macos" title="Direct link to heading">#</a></h2><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="compilation-1"></a>Compilation<a class="hash-link" href="#compilation-1" title="Direct link to heading">#</a></h3><ol><li>Clone the Pulsar repository.</li></ol><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly shell"><pre tabindex="0" class="prism-code language-shell codeBlock_23N8 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ </span><span class="token function" style="color:rgb(80, 250, 123)">git</span><span class="token plain"> clone https://github.com/apache/pulsar</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><ol start="2"><li>Install all necessary dependencies.</li></ol><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly shell"><pre tabindex="0" class="prism-code language-shell codeBlock_23N8 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># OpenSSL installation</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ brew </span><span class="token function" style="color:rgb(80, 250, 123)">install</span><span class="token plain"> openssl</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">export</span><span class="token plain"> </span><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">OPENSSL_INCLUDE_DIR</span><span class="token operator">=</span><span class="token plain">/usr/local/opt/openssl/include/</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">export</span><span class="token plain"> </span><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">OPENSSL_ROOT_DIR</span><span class="token operator">=</span><span class="token plain">/usr/local/opt/openssl/</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Protocol Buffers installation</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ brew </span><span class="token function" style="color:rgb(80, 250, 123)">install</span><span class="token plain"> protobuf boost boost-python log4cxx</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># If you are using python3, you need to install boost-python3 </span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Google Test installation</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ </span><span class="token function" style="color:rgb(80, 250, 123)">git</span><span class="token plain"> clone https://github.com/google/googletest.git</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">cd</span><span class="token plain"> googletest</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ cmake </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">.</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ </span><span class="token function" style="color:rgb(80, 250, 123)">make</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">install</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><ol start="3"><li>Compile the Pulsar client library in the repository that you cloned.</li></ol><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly shell"><pre tabindex="0" class="prism-code language-shell codeBlock_23N8 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">cd</span><span class="token plain"> pulsar-client-cpp</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ cmake </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">.</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ </span><span class="token function" style="color:rgb(80, 250, 123)">make</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="install-libpulsar"></a>Install <code>libpulsar</code><a class="hash-link" href="#install-libpulsar" title="Direct link to heading">#</a></h3><p>Pulsar releases are available in the <a href="https://brew.sh/" target="_blank" rel="noopener noreferrer">Homebrew</a> core repository. You can install the C++ client library with the following command. The package is installed with the library and headers.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly shell"><pre tabindex="0" class="prism-code language-shell codeBlock_23N8 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">brew </span><span class="token function" style="color:rgb(80, 250, 123)">install</span><span class="token plain"> libpulsar</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="windows-64-bit"></a>Windows (64-bit)<a class="hash-link" href="#windows-64-bit" title="Direct link to heading">#</a></h2><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="compilation-2"></a>Compilation<a class="hash-link" href="#compilation-2" title="Direct link to heading">#</a></h3><ol><li>Clone the Pulsar repository.</li></ol><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly shell"><pre tabindex="0" class="prism-code language-shell codeBlock_23N8 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ </span><span class="token function" style="color:rgb(80, 250, 123)">git</span><span class="token plain"> clone https://github.com/apache/pulsar</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><ol start="2"><li>Install all necessary dependencies.</li></ol><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly shell"><pre tabindex="0" class="prism-code language-shell codeBlock_23N8 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">cd</span><span class="token plain"> </span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">${PULSAR_HOME}</span><span class="token plain">/pulsar-client-cpp</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">vcpkg </span><span class="token function" style="color:rgb(80, 250, 123)">install</span><span class="token plain"> --feature-flags</span><span class="token operator">=</span><span class="token plain">manifests --triplet x64-windows</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><ol start="3"><li>Build C++ libraries.</li></ol><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly shell"><pre tabindex="0" class="prism-code language-shell codeBlock_23N8 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">cmake -B ./build -A x64 -DBUILD_PYTHON_WRAPPER</span><span class="token operator">=</span><span class="token plain">OFF -DBUILD_TESTS</span><span class="token operator">=</span><span class="token plain">OFF -DVCPKG_TRIPLET</span><span class="token operator">=</span><span class="token plain">x64-windows -DCMAKE_BUILD_TYPE</span><span class="token operator">=</span><span class="token plain">Release -S </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">.</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">cmake --build ./build --config Release</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><blockquote><p><strong>NOTE</strong></p><ol><li>For Windows 32-bit, you need to use <code>-A Win32</code> and <code>-DVCPKG_TRIPLET=x86-windows</code>.</li><li>For MSVC Debug mode, you need to replace <code>Release</code> with <code>Debug</code> for both <code>CMAKE_BUILD_TYPE</code> variable and <code>--config</code> option.</li></ol></blockquote><ol start="4"><li>Client libraries are available in the following places.</li></ol><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">${PULSAR_HOME}/pulsar-client-cpp/build/lib/Release/pulsar.lib</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">${PULSAR_HOME}/pulsar-client-cpp/build/lib/Release/pulsar.dll</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="connection-urls"></a>Connection URLs<a class="hash-link" href="#connection-urls" title="Direct link to heading">#</a></h2><p>To connect Pulsar using client libraries, you need to specify a Pulsar protocol URL.</p><p>Pulsar protocol URLs are assigned to specific clusters, you can use the Pulsar URI scheme. The default port is <code>6650</code>. The following is an example for localhost.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly http"><pre tabindex="0" class="prism-code language-http codeBlock_23N8 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">pulsar://localhost:6650</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>In a Pulsar cluster in production, the URL looks as follows. </p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly http"><pre tabindex="0" class="prism-code language-http codeBlock_23N8 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">pulsar://pulsar.us-west.example.com:6650</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>If you use TLS authentication, you need to add <code>ssl</code>, and the default port is <code>6651</code>. The following is an example.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly http"><pre tabindex="0" class="prism-code language-http codeBlock_23N8 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">pulsar+ssl://pulsar.us-west.example.com:6651</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="create-a-consumer"></a>Create a consumer<a class="hash-link" href="#create-a-consumer" title="Direct link to heading">#</a></h2><p>To use Pulsar as a consumer, you need to create a consumer on the C++ client. There are two main ways of using the consumer:</p><ul><li><a href="#blocking-example">Blocking style</a>: synchronously calling <code>receive(msg)</code>.</li><li><a href="#consumer-with-a-message-listener">Non-blocking</a> (event based) style: using a message listener.</li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="blocking-example"></a>Blocking example<a class="hash-link" href="#blocking-example" title="Direct link to heading">#</a></h3><p>The benefit of this approach is that it is the simplest code. Simply keeps calling <code>receive(msg)</code> which blocks until a message is received.</p><p>This example starts a subscription at the earliest offset and consumes 100 messages.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly c++"><pre tabindex="0" class="prism-code language-c++ codeBlock_23N8 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">#include &lt;pulsar/Client.h&gt;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">using namespace pulsar;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">int main() {</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    Client client(&quot;pulsar://localhost:6650&quot;);</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    Consumer consumer;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    ConsumerConfiguration config;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    config.setSubscriptionInitialPosition(InitialPositionEarliest);</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    Result result = client.subscribe(&quot;persistent://public/default/my-topic&quot;, &quot;consumer-1&quot;, config, consumer);</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    if (result != ResultOk) {</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        std::cout &lt;&lt; &quot;Failed to subscribe: &quot; &lt;&lt; result &lt;&lt; std::endl;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        return -1;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    Message msg;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    int ctr = 0;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    // consume 100 messages</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    while (ctr &lt; 100) {</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        consumer.receive(msg);</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        std::cout &lt;&lt; &quot;Received: &quot; &lt;&lt; msg</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            &lt;&lt; &quot;  with payload &#x27;&quot; &lt;&lt; msg.getDataAsString() &lt;&lt; &quot;&#x27;&quot; &lt;&lt; std::endl;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        consumer.acknowledge(msg);</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        ctr++;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    std::cout &lt;&lt; &quot;Finished consuming synchronously!&quot; &lt;&lt; std::endl;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    client.close();</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    return 0;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="consumer-with-a-message-listener"></a>Consumer with a message listener<a class="hash-link" href="#consumer-with-a-message-listener" title="Direct link to heading">#</a></h3><p>You can avoid  running a loop with blocking calls with an event based style by using a message listener which is invoked for each message that is received.</p><p>This example starts a subscription at the earliest offset and consumes 100 messages.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly c++"><pre tabindex="0" class="prism-code language-c++ codeBlock_23N8 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">#include &lt;pulsar/Client.h&gt;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">#include &lt;atomic&gt;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">#include &lt;thread&gt;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">using namespace pulsar;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">std::atomic&lt;uint32_t&gt; messagesReceived;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">void handleAckComplete(Result res) {</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    std::cout &lt;&lt; &quot;Ack res: &quot; &lt;&lt; res &lt;&lt; std::endl;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">void listener(Consumer consumer, const Message&amp; msg) {</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    std::cout &lt;&lt; &quot;Got message &quot; &lt;&lt; msg &lt;&lt; &quot; with content &#x27;&quot; &lt;&lt; msg.getDataAsString() &lt;&lt; &quot;&#x27;&quot; &lt;&lt; std::endl;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    messagesReceived++;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    consumer.acknowledgeAsync(msg.getMessageId(), handleAckComplete);</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">int main() {</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    Client client(&quot;pulsar://localhost:6650&quot;);</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    Consumer consumer;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    ConsumerConfiguration config;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    config.setMessageListener(listener);</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    config.setSubscriptionInitialPosition(InitialPositionEarliest);</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    Result result = client.subscribe(&quot;persistent://public/default/my-topic&quot;, &quot;consumer-1&quot;, config, consumer);</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    if (result != ResultOk) {</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        std::cout &lt;&lt; &quot;Failed to subscribe: &quot; &lt;&lt; result &lt;&lt; std::endl;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        return -1;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    // wait for 100 messages to be consumed</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    while (messagesReceived &lt; 100) {</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        std::this_thread::sleep_for(std::chrono::milliseconds(100));</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    std::cout &lt;&lt; &quot;Finished consuming asynchronously!&quot; &lt;&lt; std::endl;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    client.close();</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    return 0;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="create-a-producer"></a>Create a producer<a class="hash-link" href="#create-a-producer" title="Direct link to heading">#</a></h2><p>To use Pulsar as a producer, you need to create a producer on the C++ client. There are two main ways of using a producer:</p><ul><li><a href="#simple-blocking-example">Blocking style</a> : each call to <code>send</code> waits for an ack from the broker.</li><li><a href="#non-blocking-example">Non-blocking asynchronous style</a> : <code>sendAsync</code> is called instead of <code>send</code> and a callback is supplied for when the ack is received from the broker.</li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="simple-blocking-example"></a>Simple blocking example<a class="hash-link" href="#simple-blocking-example" title="Direct link to heading">#</a></h3><p>This example sends 100 messages using the blocking style. While simple, it does not produce high throughput as it waits for each ack to come back before sending the next message.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly c++"><pre tabindex="0" class="prism-code language-c++ codeBlock_23N8 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">#include &lt;pulsar/Client.h&gt;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">#include &lt;thread&gt;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">using namespace pulsar;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">int main() {</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    Client client(&quot;pulsar://localhost:6650&quot;);</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    Result result = client.createProducer(&quot;persistent://public/default/my-topic&quot;, producer);</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    if (result != ResultOk) {</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        std::cout &lt;&lt; &quot;Error creating producer: &quot; &lt;&lt; result &lt;&lt; std::endl;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        return -1;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    // Send 100 messages synchronously</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    int ctr = 0;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    while (ctr &lt; 100) {</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        std::string content = &quot;msg&quot; + std::to_string(ctr);</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        Message msg = MessageBuilder().setContent(content).setProperty(&quot;x&quot;, &quot;1&quot;).build();</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        Result result = producer.send(msg);</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        if (result != ResultOk) {</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            std::cout &lt;&lt; &quot;The message &quot; &lt;&lt; content &lt;&lt; &quot; could not be sent, received code: &quot; &lt;&lt; result &lt;&lt; std::endl;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        } else {</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            std::cout &lt;&lt; &quot;The message &quot; &lt;&lt; content &lt;&lt; &quot; sent successfully&quot; &lt;&lt; std::endl;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        }</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        std::this_thread::sleep_for(std::chrono::milliseconds(100));</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        ctr++;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    std::cout &lt;&lt; &quot;Finished producing synchronously!&quot; &lt;&lt; std::endl;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    client.close();</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    return 0;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="non-blocking-example"></a>Non-blocking example<a class="hash-link" href="#non-blocking-example" title="Direct link to heading">#</a></h3><p>This example sends 100 messages using the non-blocking style calling <code>sendAsync</code> instead of <code>send</code>. This allows the producer to have multiple messages inflight at a time which increases throughput.</p><p>The producer configuration <code>blockIfQueueFull</code> is useful here to avoid <code>ResultProducerQueueIsFull</code> errors when the internal queue for outgoing send requests becomes full. Once the internal queue is full, <code>sendAsync</code> becomes blocking which can make your code simpler.</p><p>Without this configuration, the result code <code>ResultProducerQueueIsFull</code> is passed to the callback. You must decide how to deal with that (retry, discard etc).</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly c++"><pre tabindex="0" class="prism-code language-c++ codeBlock_23N8 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">#include &lt;pulsar/Client.h&gt;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">#include &lt;thread&gt;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">using namespace pulsar;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">std::atomic&lt;uint32_t&gt; acksReceived;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">void callback(Result code, const MessageId&amp; msgId, std::string msgContent) {</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    // message processing logic here</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    std::cout &lt;&lt; &quot;Received ack for msg: &quot; &lt;&lt; msgContent &lt;&lt; &quot; with code: &quot;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        &lt;&lt; code &lt;&lt; &quot; -- MsgID: &quot; &lt;&lt; msgId &lt;&lt; std::endl;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    acksReceived++;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">int main() {</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    Client client(&quot;pulsar://localhost:6650&quot;);</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    ProducerConfiguration producerConf;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    producerConf.setBlockIfQueueFull(true);</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    Producer producer;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    Result result = client.createProducer(&quot;persistent://public/default/my-topic&quot;,</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                                          producerConf, producer);</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    if (result != ResultOk) {</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        std::cout &lt;&lt; &quot;Error creating producer: &quot; &lt;&lt; result &lt;&lt; std::endl;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        return -1;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    // Send 100 messages asynchronously</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    int ctr = 0;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    while (ctr &lt; 100) {</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        std::string content = &quot;msg&quot; + std::to_string(ctr);</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        Message msg = MessageBuilder().setContent(content).setProperty(&quot;x&quot;, &quot;1&quot;).build();</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        producer.sendAsync(msg, std::bind(callback,</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                                          std::placeholders::_1, std::placeholders::_2, content));</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        std::this_thread::sleep_for(std::chrono::milliseconds(100));</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        ctr++;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    // wait for 100 messages to be acked</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    while (acksReceived &lt; 100) {</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        std::this_thread::sleep_for(std::chrono::milliseconds(100));</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    std::cout &lt;&lt; &quot;Finished producing asynchronously!&quot; &lt;&lt; std::endl;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    client.close();</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    return 0;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="partitioned-topics-and-lazy-producers"></a>Partitioned topics and lazy producers<a class="hash-link" href="#partitioned-topics-and-lazy-producers" title="Direct link to heading">#</a></h3><p>When scaling out a Pulsar topic, you may configure a topic to have hundreds of partitions. Likewise, you may have also scaled out your producers so there are hundreds or even thousands of producers. This can put some strain on the Pulsar brokers as when you create a producer on a partitioned topic, internally it creates one internal producer per partition which involves communications to the brokers for each one. So for a topic with 1000 partitions and 1000 producers, it ends up creating 1,000,000 internal producers across the producer applications, each of which has to communicate with a broker to find out which broker it should connect to and then perform the connection handshake.</p><p>You can reduce the load caused by this combination of a large number of partitions and many producers by doing the following:</p><ul><li>use SinglePartition partition routing mode (this ensures that all messages are only sent to a single, randomly selected partition)</li><li>use non-keyed messages (when messages are keyed, routing is based on the hash of the key and so messages will end up being sent to multiple partitions)</li><li>use lazy producers (this ensures that an internal producer is only created on demand when a message needs to be routed to a partition)</li></ul><p>With our example above, that reduces the number of internal producers spread out over the 1000 producer apps from 1,000,000 to just 1000.</p><p>Note that there can be extra latency for the first message sent. If you set a low send timeout, this timeout could be reached if the initial connection handshake is slow to complete.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly c++"><pre tabindex="0" class="prism-code language-c++ codeBlock_23N8 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">ProducerConfiguration producerConf;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">producerConf.setPartitionsRoutingMode(ProducerConfiguration::UseSinglePartition);</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">producerConf.setLazyStartPartitionedProducers(true);</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="enable-authentication-in-connection-urls"></a>Enable authentication in connection URLs<a class="hash-link" href="#enable-authentication-in-connection-urls" title="Direct link to heading">#</a></h2><p>If you use TLS authentication when connecting to Pulsar, you need to add <code>ssl</code> in the connection URLs, and the default port is <code>6651</code>. The following is an example.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly cpp"><pre tabindex="0" class="prism-code language-cpp codeBlock_23N8 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">ClientConfiguration config </span><span class="token operator">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">ClientConfiguration</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">config</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">setUseTls</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token boolean">true</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">config</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">setTlsTrustCertsFilePath</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;/path/to/cacert.pem&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">config</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">setTlsAllowInsecureConnection</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token boolean">false</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">config</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">setAuth</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">pulsar</span><span class="token operator">::</span><span class="token class-name">AuthTls</span><span class="token operator">::</span><span class="token function" style="color:rgb(80, 250, 123)">create</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;/path/to/client-cert.pem&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;/path/to/client-key.pem&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Client </span><span class="token function" style="color:rgb(80, 250, 123)">client</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;pulsar+ssl://my-broker.com:6651&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> config</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>For complete examples, refer to <a href="https://github.com/apache/pulsar/tree/master/pulsar-client-cpp/examples" target="_blank" rel="noopener noreferrer">C++ client examples</a>.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="schema"></a>Schema<a class="hash-link" href="#schema" title="Direct link to heading">#</a></h2><p>This section describes some examples about schema. For more information about
schema, see <a href="/docs/next/schema-get-started">Pulsar schema</a>.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="avro-schema"></a>Avro schema<a class="hash-link" href="#avro-schema" title="Direct link to heading">#</a></h3><ul><li><p>The following example shows how to create a producer with an Avro schema.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly cpp"><pre tabindex="0" class="prism-code language-cpp codeBlock_23N8 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">static</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">const</span><span class="token plain"> std</span><span class="token operator">::</span><span class="token plain">string exampleSchema </span><span class="token operator">=</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;{\&quot;type\&quot;:\&quot;record\&quot;,\&quot;name\&quot;:\&quot;Example\&quot;,\&quot;namespace\&quot;:\&quot;test\&quot;,&quot;</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;\&quot;fields\&quot;:[{\&quot;name\&quot;:\&quot;a\&quot;,\&quot;type\&quot;:\&quot;int\&quot;},{\&quot;name\&quot;:\&quot;b\&quot;,\&quot;type\&quot;:\&quot;int\&quot;}]}&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Producer producer</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">ProducerConfiguration producerConf</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">producerConf</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">setSchema</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token function" style="color:rgb(80, 250, 123)">SchemaInfo</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">AVRO</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Avro&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> exampleSchema</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">client</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">createProducer</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;topic-avro&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> producerConf</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> producer</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div></li><li><p>The following example shows how to create a consumer with an Avro schema.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly cpp"><pre tabindex="0" class="prism-code language-cpp codeBlock_23N8 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">static</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">const</span><span class="token plain"> std</span><span class="token operator">::</span><span class="token plain">string exampleSchema </span><span class="token operator">=</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;{\&quot;type\&quot;:\&quot;record\&quot;,\&quot;name\&quot;:\&quot;Example\&quot;,\&quot;namespace\&quot;:\&quot;test\&quot;,&quot;</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;\&quot;fields\&quot;:[{\&quot;name\&quot;:\&quot;a\&quot;,\&quot;type\&quot;:\&quot;int\&quot;},{\&quot;name\&quot;:\&quot;b\&quot;,\&quot;type\&quot;:\&quot;int\&quot;}]}&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">ConsumerConfiguration consumerConf</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Consumer consumer</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">consumerConf</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">setSchema</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token function" style="color:rgb(80, 250, 123)">SchemaInfo</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">AVRO</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Avro&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> exampleSchema</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">client</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">subscribe</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;topic-avro&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;sub-2&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> consumerConf</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> consumer</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div></li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="protobufnative-schema"></a>ProtobufNative schema<a class="hash-link" href="#protobufnative-schema" title="Direct link to heading">#</a></h3><p>The following example shows how to create a producer and a consumer with a ProtobufNative schema.
â€‹</p><ol><li><p>Generate the <code>User</code> class using Protobuf3. </p><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</h5></div><div class="admonition-content"><p>You need to use Protobuf3 or later versions.</p></div></div></li></ol><p>â€‹</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly protobuf"><pre tabindex="0" class="prism-code language-protobuf codeBlock_23N8 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">syntax = &quot;proto3&quot;;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">message User {</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    string name = 1;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    int32 age = 2;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>â€‹
2. Include the <code>ProtobufNativeSchema.h</code> in your source code. Ensure the Protobuf dependency has been added to your project.
â€‹</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly c++"><pre tabindex="0" class="prism-code language-c++ codeBlock_23N8 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">#include &lt;pulsar/ProtobufNativeSchema.h&gt;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>â€‹
3. Create a producer to send a <code>User</code> instance.
â€‹</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly c++"><pre tabindex="0" class="prism-code language-c++ codeBlock_23N8 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">ProducerConfiguration producerConf;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">producerConf.setSchema(createProtobufNativeSchema(User::GetDescriptor()));</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Producer producer;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">client.createProducer(&quot;topic-protobuf&quot;, producerConf, producer);</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">User user;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">user.set_name(&quot;my-name&quot;);</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">user.set_age(10);</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">std::string content;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">user.SerializeToString(&amp;content);</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">producer.send(MessageBuilder().setContent(content).build());</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>â€‹
4. Create a consumer to receive a <code>User</code> instance.
â€‹</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly c++"><pre tabindex="0" class="prism-code language-c++ codeBlock_23N8 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">ConsumerConfiguration consumerConf;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">consumerConf.setSchema(createProtobufNativeSchema(User::GetDescriptor()));</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">consumerConf.setSubscriptionInitialPosition(InitialPositionEarliest);</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Consumer consumer;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">client.subscribe(&quot;topic-protobuf&quot;, &quot;my-sub&quot;, consumerConf, consumer);</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Message msg;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">consumer.receive(msg);</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">User user2;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">user2.ParseFromArray(msg.getData(), msg.getLength());</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/apache/pulsar/edit/master/site2/website-next/docs/client-libraries-cpp.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_2_ui" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_13-_"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/next/client-libraries-python"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« Python</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs/next/client-libraries-node"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Node.js Â»</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_35-E thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#supported-platforms" class="table-of-contents__link">Supported platforms</a></li><li><a href="#system-requirements" class="table-of-contents__link">System requirements</a></li><li><a href="#linux" class="table-of-contents__link">Linux</a><ul><li><a href="#compilation" class="table-of-contents__link">Compilation</a></li><li><a href="#install-dependencies" class="table-of-contents__link">Install Dependencies</a></li><li><a href="#install-rpm" class="table-of-contents__link">Install RPM</a></li><li><a href="#install-debian" class="table-of-contents__link">Install Debian</a></li><li><a href="#build" class="table-of-contents__link">Build</a></li></ul></li><li><a href="#macos" class="table-of-contents__link">MacOS</a><ul><li><a href="#compilation-1" class="table-of-contents__link">Compilation</a></li><li><a href="#install-libpulsar" class="table-of-contents__link">Install <code>libpulsar</code></a></li></ul></li><li><a href="#windows-64-bit" class="table-of-contents__link">Windows (64-bit)</a><ul><li><a href="#compilation-2" class="table-of-contents__link">Compilation</a></li></ul></li><li><a href="#connection-urls" class="table-of-contents__link">Connection URLs</a></li><li><a href="#create-a-consumer" class="table-of-contents__link">Create a consumer</a><ul><li><a href="#blocking-example" class="table-of-contents__link">Blocking example</a></li><li><a href="#consumer-with-a-message-listener" class="table-of-contents__link">Consumer with a message listener</a></li></ul></li><li><a href="#create-a-producer" class="table-of-contents__link">Create a producer</a><ul><li><a href="#simple-blocking-example" class="table-of-contents__link">Simple blocking example</a></li><li><a href="#non-blocking-example" class="table-of-contents__link">Non-blocking example</a></li><li><a href="#partitioned-topics-and-lazy-producers" class="table-of-contents__link">Partitioned topics and lazy producers</a></li></ul></li><li><a href="#enable-authentication-in-connection-urls" class="table-of-contents__link">Enable authentication in connection URLs</a></li><li><a href="#schema" class="table-of-contents__link">Schema</a><ul><li><a href="#avro-schema" class="table-of-contents__link">Avro schema</a></li><li><a href="#protobufnative-schema" class="table-of-contents__link">ProtobufNative schema</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="footer__bottom text--center"><div class="footer__copyright">Inc.Copyright Â© 2021 The Apache Software Foundation. All Rights Reserved. Apache, Apache Pulsar and the Apache feather logo are trademarks of The Apache Software Foundation.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.668ae9d7.js"></script>
<script src="/assets/js/main.3d3de418.js"></script>
</body>
</html>