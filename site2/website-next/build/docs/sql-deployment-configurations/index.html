<!doctype html>
<html class="docs-version-2.8.0" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.6">
<link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Apache Pulsar Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Apache Pulsar Blog Atom Feed"><title data-react-helmet="true">Pulsar SQL configuration and deployment | Apache Pulsar</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://pulsar.apache.com/docs/sql-deployment-configurations"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="2.8.0"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-2.8.0"><meta data-react-helmet="true" property="og:title" content="Pulsar SQL configuration and deployment | Apache Pulsar"><meta data-react-helmet="true" name="description" content="You can configure Presto Pulsar connector and deploy a cluster with the following instruction."><meta data-react-helmet="true" property="og:description" content="You can configure Presto Pulsar connector and deploy a cluster with the following instruction."><link data-react-helmet="true" rel="shortcut icon" href="/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://pulsar.apache.com/docs/sql-deployment-configurations"><link data-react-helmet="true" rel="alternate" href="https://pulsar.apache.com/docs/sql-deployment-configurations" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://pulsar.apache.com/docs/sql-deployment-configurations" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.4a6b6be2.css">
<link rel="preload" href="/assets/js/runtime~main.668ae9d7.js" as="script">
<link rel="preload" href="/assets/js/main.3d3de418.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_1oUP">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><img src="/img/logo.svg" alt="Apache Pulsar" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/img/logo.svg" alt="Apache Pulsar" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><b class="navbar__title"></b></a><a class="navbar__item navbar__link navbar__link--active" href="/docs/">Docs</a><a class="navbar__item navbar__link" href="/versions">Versions</a><a class="navbar__item navbar__link" href="/blog">Blog</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/apache/pulsar" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a aria-current="page" class="navbar__link" href="/docs">Version</a><ul class="dropdown__menu"><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/docs/">2.8.0</a></li><li><a class="dropdown__link" href="/docs/2.7.3/">2.7.3</a></li><li><a class="dropdown__link" href="/docs/2.7.2/">2.7.2</a></li><li><a class="dropdown__link" href="/docs/2.7.1/">2.7.1</a></li><li><a class="dropdown__link" href="/docs/2.7.0/">2.7.0</a></li><li><a class="dropdown__link" href="/docs/2.6.4/">2.6.4</a></li><li><a class="dropdown__link" href="/docs/2.6.3/">2.6.3</a></li><li><a class="dropdown__link" href="/docs/2.6.2/">2.6.2</a></li><li><a class="dropdown__link" href="/docs/2.2.0/">2.2.0</a></li></ul></div><div class="react-toggle toggle_3Zt9 react-toggle--disabled"><div class="react-toggle-track" role="button" tabindex="-1"><div class="react-toggle-track-check"><span class="toggle_71bT">ðŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_71bT">ðŸŒž</span></div><div class="react-toggle-thumb"></div></div><input type="checkbox" class="react-toggle-screenreader-only" aria-label="Switch between dark and light mode"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_31aa"><button class="clean-btn backToTopButton_35hR" type="button"><svg viewBox="0 0 24 24" width="28"><path d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z" fill="currentColor"></path></svg></button><aside class="docSidebarContainer_3Kbt"><div class="sidebar_15mo"><nav class="menu thin-scrollbar menu_Bmed menuWithAnnouncementBar_2WvA"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Get Started</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Concepts and Architecture</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Pulsar Schema</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Pulsar Functions</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Pulsar IO</a></li><li class="theme-doc-sidebar-item-category menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#">Pulsar SQL</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/docs/sql-overview">Overview</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/docs/sql-getting-started">Query data</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/sql-deployment-configurations">Configuration and deployment</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/docs/sql-rest-api">REST APIs</a></li></ul></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Tiered Storage</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Transactions</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Kubernetes (Helm)</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Deployment</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Administration</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Security</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Performance</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Client Libraries</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Admin API</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Adaptors</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Cookbooks</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Development</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Reference</a></li></ul></nav></div></aside><main class="docMainContainer_3ufF"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_3FnS"><div class="docItemContainer_33ec"><article><span class="theme-doc-version-badge badge badge--secondary">Version: 2.8.0</span><div class="tocCollapsible_1PrD theme-doc-toc-mobile tocMobile_3Hoh"><button type="button" class="clean-btn tocCollapsibleButton_2O1e">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Pulsar SQL configuration and deployment</h1></header><p>You can configure Presto Pulsar connector and deploy a cluster with the following instruction.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="configure-presto-pulsar-connector"></a>Configure Presto Pulsar Connector<a class="hash-link" href="#configure-presto-pulsar-connector" title="Direct link to heading">#</a></h2><p>You can configure Presto Pulsar Connector in the <code>${project.root}/conf/presto/catalog/pulsar.properties</code> properties file. The configuration for the connector and the default values are as follows.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly properties"><pre tabindex="0" class="prism-code language-properties codeBlock_23N8 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># name of the connector to be displayed in the catalog</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">connector.name=pulsar</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># the url of Pulsar broker service</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">pulsar.web-service-url=http://localhost:8080</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># URI of Zookeeper cluster</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">pulsar.zookeeper-uri=localhost:2181</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># minimum number of entries to read at a single time</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">pulsar.entry-read-batch-size=100</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># default number of splits to use per query</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">pulsar.target-num-splits=4</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>You can connect Presto to a Pulsar cluster with multiple hosts. To configure multiple hosts for brokers, add multiple URLs to <code>pulsar.web-service-url</code>. To configure multiple hosts for ZooKeeper, add multiple URIs to <code>pulsar.zookeeper-uri</code>. The following is an example.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">pulsar.web-service-url=http://localhost:8080,localhost:8081,localhost:8082</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">pulsar.zookeeper-uri=localhost1,localhost2:2181</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="query-data-from-existing-presto-clusters"></a>Query data from existing Presto clusters<a class="hash-link" href="#query-data-from-existing-presto-clusters" title="Direct link to heading">#</a></h2><p>If you already have a Presto cluster, you can copy the Presto Pulsar connector plugin to your existing cluster. Download the archived plugin package with the following command.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ </span><span class="token function" style="color:rgb(80, 250, 123)">wget</span><span class="token plain"> https://archive.apache.org/dist/pulsar/pulsar-2.8.0/apache-pulsar-2.8.0-bin.tar.gz</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="deploy-a-new-cluster"></a>Deploy a new cluster<a class="hash-link" href="#deploy-a-new-cluster" title="Direct link to heading">#</a></h2><p>Since Pulsar SQL is powered by <a href="https://trino.io" target="_blank" rel="noopener noreferrer">Trino (formerly Presto SQL)</a>, the configuration for deployment is the same for the Pulsar SQL worker. </p><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</h5></div><div class="admonition-content"><p>For how to set up a standalone single node environment, refer to <a href="/docs/sql-getting-started">Query data</a>. </p></div></div><p>You can use the same CLI args as the Presto launcher.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ ./bin/pulsar sql-worker --help</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Usage: launcher </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">options</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"> </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">command</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Commands: run, start, stop, restart, kill, status</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Options:</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  -h, --help            show this </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">help</span><span class="token plain"> message and </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">exit</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  -v, --verbose         Run verbosely</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  --etc-dir</span><span class="token operator">=</span><span class="token plain">DIR         Defaults to INSTALL_PATH/etc</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  --launcher-config</span><span class="token operator">=</span><span class="token plain">FILE</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                        Defaults to INSTALL_PATH/bin/launcher.properties</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  --node-config</span><span class="token operator">=</span><span class="token plain">FILE    Defaults to ETC_DIR/node.properties</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  --jvm-config</span><span class="token operator">=</span><span class="token plain">FILE     Defaults to ETC_DIR/jvm.config</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  --config</span><span class="token operator">=</span><span class="token plain">FILE         Defaults to ETC_DIR/config.properties</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  --log-levels-file</span><span class="token operator">=</span><span class="token plain">FILE</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                        Defaults to ETC_DIR/log.properties</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  --data-dir</span><span class="token operator">=</span><span class="token plain">DIR        Defaults to INSTALL_PATH</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  --pid-file</span><span class="token operator">=</span><span class="token plain">FILE       Defaults to DATA_DIR/var/run/launcher.pid</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  --launcher-log-file</span><span class="token operator">=</span><span class="token plain">FILE</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                        Defaults to DATA_DIR/var/log/launcher.log </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">only </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">in</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                        daemon mode</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  --server-log-file</span><span class="token operator">=</span><span class="token plain">FILE</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                        Defaults to DATA_DIR/var/log/server.log </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">only </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">in</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                        daemon mode</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  -D </span><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">NAME</span><span class="token operator">=</span><span class="token plain">VALUE         Set a Java system property</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>The default configuration for the cluster is located in <code>${project.root}/conf/presto</code>. You can customize your deployment by modifying the default configuration.</p><p>You can set the worker to read from a different configuration directory, or set a different directory to write data. </p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ ./bin/pulsar sql-worker run --etc-dir /tmp/incubator-pulsar/conf/presto --data-dir /tmp/presto-1</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>You can start the worker as daemon process.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ ./bin/pulsar sql-worker start</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="deploy-a-cluster-on-multiple-nodes"></a>Deploy a cluster on multiple nodes<a class="hash-link" href="#deploy-a-cluster-on-multiple-nodes" title="Direct link to heading">#</a></h3><p>You can deploy a Pulsar SQL cluster or Presto cluster on multiple nodes. The following example shows how to deploy a cluster on three-node cluster. </p><ol><li>Copy the Pulsar binary distribution to three nodes.</li></ol><p>The first node runs as Presto coordinator. The minimal configuration requirement in the <code>${project.root}/conf/presto/config.properties</code> file is as follows. </p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly properties"><pre tabindex="0" class="prism-code language-properties codeBlock_23N8 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">coordinator=true</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">node-scheduler.include-coordinator=true</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">http-server.http.port=8080</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">query.max-memory=50GB</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">query.max-memory-per-node=1GB</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">discovery-server.enabled=true</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">discovery.uri=&lt;coordinator-url&gt;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>The other two nodes serve as worker nodes, you can use the following configuration for worker nodes. </p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly properties"><pre tabindex="0" class="prism-code language-properties codeBlock_23N8 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">coordinator=false</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">http-server.http.port=8080</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">query.max-memory=50GB</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">query.max-memory-per-node=1GB</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">discovery.uri=&lt;coordinator-url&gt;</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><ol start="2"><li><p>Modify <code>pulsar.web-service-url</code> and  <code>pulsar.zookeeper-uri</code> configuration in the <code>${project.root}/conf/presto/catalog/pulsar.properties</code> file accordingly for the three nodes.</p></li><li><p>Start the coordinator node.</p></li></ol><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ ./bin/pulsar sql-worker run</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><ol start="4"><li>Start worker nodes.</li></ol><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ ./bin/pulsar sql-worker run</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><ol start="5"><li>Start the SQL CLI and check the status of your cluster.</li></ol><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ ./bin/pulsar sql --server </span><span class="token operator">&lt;</span><span class="token plain">coordinate_url</span><span class="token operator">&gt;</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><ol start="6"><li>Check the status of your nodes.</li></ol><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">presto</span><span class="token operator">&gt;</span><span class="token plain"> SELECT * FROM system.runtime.nodes</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> node_id </span><span class="token operator">|</span><span class="token plain">        http_uri         </span><span class="token operator">|</span><span class="token plain"> node_version </span><span class="token operator">|</span><span class="token plain"> coordinator </span><span class="token operator">|</span><span class="token plain"> state  </span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">---------+-------------------------+--------------+-------------+--------</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> </span><span class="token number">1</span><span class="token plain">       </span><span class="token operator">|</span><span class="token plain"> http://192.168.2.1:8081 </span><span class="token operator">|</span><span class="token plain"> testversion  </span><span class="token operator">|</span><span class="token plain"> </span><span class="token boolean">true</span><span class="token plain">        </span><span class="token operator">|</span><span class="token plain"> active </span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> </span><span class="token number">3</span><span class="token plain">       </span><span class="token operator">|</span><span class="token plain"> http://192.168.2.2:8081 </span><span class="token operator">|</span><span class="token plain"> testversion  </span><span class="token operator">|</span><span class="token plain"> </span><span class="token boolean">false</span><span class="token plain">       </span><span class="token operator">|</span><span class="token plain"> active </span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> </span><span class="token number">2</span><span class="token plain">       </span><span class="token operator">|</span><span class="token plain"> http://192.168.2.3:8081 </span><span class="token operator">|</span><span class="token plain"> testversion  </span><span class="token operator">|</span><span class="token plain"> </span><span class="token boolean">false</span><span class="token plain">       </span><span class="token operator">|</span><span class="token plain"> active</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>For more information about deployment in Presto, refer to <a href="https://trino.io/docs/current/installation/deployment.html" target="_blank" rel="noopener noreferrer">Presto deployment</a>.</p><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</h5></div><div class="admonition-content"><p>The broker does not advance LAC, so when Pulsar SQL bypass broker to query data, it can only read entries up to the LAC that all the bookies learned. You can enable periodically write LAC on the broker by setting &quot;bookkeeperExplicitLacIntervalInMills&quot; in the broker.conf.</p></div></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/apache/pulsar/edit/master/site2/website-next/versioned_docs/version-2.8.0/sql-deployment-configurations.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_2_ui" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_13-_"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/sql-getting-started"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« Query data</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs/sql-rest-api"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">REST APIs Â»</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_35-E thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#configure-presto-pulsar-connector" class="table-of-contents__link">Configure Presto Pulsar Connector</a></li><li><a href="#query-data-from-existing-presto-clusters" class="table-of-contents__link">Query data from existing Presto clusters</a></li><li><a href="#deploy-a-new-cluster" class="table-of-contents__link">Deploy a new cluster</a><ul><li><a href="#deploy-a-cluster-on-multiple-nodes" class="table-of-contents__link">Deploy a cluster on multiple nodes</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="footer__bottom text--center"><div class="footer__copyright">Inc.Copyright Â© 2021 The Apache Software Foundation. All Rights Reserved. Apache, Apache Pulsar and the Apache feather logo are trademarks of The Apache Software Foundation.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.668ae9d7.js"></script>
<script src="/assets/js/main.3d3de418.js"></script>
</body>
</html>