<!doctype html>
<html class="docs-version-2.7.0" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.6">
<link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Apache Pulsar Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Apache Pulsar Blog Atom Feed"><title data-react-helmet="true">Upgrade Guide | Apache Pulsar</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://pulsar.apache.com/docs/2.7.0/administration-upgrade"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="2.7.0"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-2.7.0"><meta data-react-helmet="true" property="og:title" content="Upgrade Guide | Apache Pulsar"><meta data-react-helmet="true" name="description" content="Upgrade guidelines"><meta data-react-helmet="true" property="og:description" content="Upgrade guidelines"><link data-react-helmet="true" rel="shortcut icon" href="/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://pulsar.apache.com/docs/2.7.0/administration-upgrade"><link data-react-helmet="true" rel="alternate" href="https://pulsar.apache.com/docs/2.7.0/administration-upgrade" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://pulsar.apache.com/docs/2.7.0/administration-upgrade" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.4a6b6be2.css">
<link rel="preload" href="/assets/js/runtime~main.668ae9d7.js" as="script">
<link rel="preload" href="/assets/js/main.3d3de418.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_1oUP">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><img src="/img/logo.svg" alt="Apache Pulsar" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/img/logo.svg" alt="Apache Pulsar" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><b class="navbar__title"></b></a><a class="navbar__item navbar__link navbar__link--active" href="/docs/2.7.0/">Docs</a><a class="navbar__item navbar__link" href="/versions">Versions</a><a class="navbar__item navbar__link" href="/blog">Blog</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/apache/pulsar" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a aria-current="page" class="navbar__link" href="/docs">Version</a><ul class="dropdown__menu"><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/docs/">2.8.0</a></li><li><a class="dropdown__link" href="/docs/2.7.3/">2.7.3</a></li><li><a class="dropdown__link" href="/docs/2.7.2/">2.7.2</a></li><li><a class="dropdown__link" href="/docs/2.7.1/">2.7.1</a></li><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/docs/2.7.0/">2.7.0</a></li><li><a class="dropdown__link" href="/docs/2.6.4/">2.6.4</a></li><li><a class="dropdown__link" href="/docs/2.6.3/">2.6.3</a></li><li><a class="dropdown__link" href="/docs/2.6.2/">2.6.2</a></li><li><a class="dropdown__link" href="/docs/2.2.0/">2.2.0</a></li></ul></div><div class="react-toggle toggle_3Zt9 react-toggle--disabled"><div class="react-toggle-track" role="button" tabindex="-1"><div class="react-toggle-track-check"><span class="toggle_71bT">ðŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_71bT">ðŸŒž</span></div><div class="react-toggle-thumb"></div></div><input type="checkbox" class="react-toggle-screenreader-only" aria-label="Switch between dark and light mode"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_31aa"><button class="clean-btn backToTopButton_35hR" type="button"><svg viewBox="0 0 24 24" width="28"><path d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z" fill="currentColor"></path></svg></button><aside class="docSidebarContainer_3Kbt"><div class="sidebar_15mo"><nav class="menu thin-scrollbar menu_Bmed menuWithAnnouncementBar_2WvA"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Get Started</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Concepts and Architecture</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Pulsar Schema</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Pulsar Functions</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Pulsar IO</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Pulsar SQL</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Tiered Storage</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Transactions</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Kubernetes (Helm)</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Deployment</a></li><li class="theme-doc-sidebar-item-category menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#">Administration</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/docs/2.7.0/administration-zk-bk">ZooKeeper and BookKeeper</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/docs/2.7.0/administration-geo">Geo-replication</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/docs/2.7.0/administration-pulsar-manager">Pulsar Manager</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/docs/2.7.0/administration-stats">Pulsar statistics</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/docs/2.7.0/administration-load-balance">Load balance</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/docs/2.7.0/administration-proxy">Pulsar proxy</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/2.7.0/administration-upgrade">Upgrade</a></li></ul></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Security</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Performance</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Client Libraries</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Admin API</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Adaptors</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Cookbooks</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Development</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Reference</a></li></ul></nav></div></aside><main class="docMainContainer_3ufF"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_3FnS"><div class="theme-doc-version-banner alert alert--warning margin-bottom--md" role="alert"><div>This is documentation for Apache Pulsar <b>2.7.0</b>, which is no longer actively maintained.</div><div class="margin-top--md">For up-to-date documentation, see the <b><a href="/docs/administration-upgrade">latest version</a></b> (2.8.0).</div></div><div class="docItemContainer_33ec"><article><span class="theme-doc-version-badge badge badge--secondary">Version: 2.7.0</span><div class="tocCollapsible_1PrD theme-doc-toc-mobile tocMobile_3Hoh"><button type="button" class="clean-btn tocCollapsibleButton_2O1e">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Upgrade Guide</h1></header><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="upgrade-guidelines"></a>Upgrade guidelines<a class="hash-link" href="#upgrade-guidelines" title="Direct link to heading">#</a></h2><p>Apache Pulsar is comprised of multiple components, ZooKeeper, bookies, and brokers. These components are either stateful or stateless. You do not have to upgrade ZooKeeper nodes unless you have special requirement. While you upgrade, you need to pay attention to bookies (stateful), brokers and proxies (stateless).</p><p>The following are some guidelines on upgrading a Pulsar cluster. Read the guidelines before upgrading.</p><ul><li>Backup all your configuration files before upgrading.</li><li>Read guide entirely, make a plan, and then execute the plan. When you make upgrade plan, you need to take your specific requirements and environment into consideration.   </li><li>Pay attention to the upgrading order of components. In general, you do not need to upgrade your ZooKeeper or configuration store cluster (the global ZooKeeper cluster). You need to upgrade bookies first, and then upgrade brokers, proxies, and your clients. </li><li>If <code>autorecovery</code> is enabled, you need to disable <code>autorecovery</code> in the upgrade process, and re-enable it after completing the process.</li><li>Read the release notes carefully for each release. Release notes contain features, configuration changes that might impact your upgrade.</li><li>Upgrade a small subset of nodes of each type to canary test the new version before upgrading all nodes of that type in the cluster. When you have upgraded the canary nodes, run for a while to ensure that they work correctly.</li><li>Upgrade one data center to verify new version before upgrading all data centers if your cluster runs in multi-cluster replicated mode.</li></ul><blockquote><p>Note: Currently, Apache Pulsar is compatible between versions. </p></blockquote><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="upgrade-sequence"></a>Upgrade sequence<a class="hash-link" href="#upgrade-sequence" title="Direct link to heading">#</a></h2><p>To upgrade an Apache Pulsar cluster, follow the upgrade sequence.</p><ol><li>Upgrade ZooKeeper (optional)  </li></ol><ul><li>Canary test: test an upgraded version in one or a small set of ZooKeeper nodes.  </li><li>Rolling upgrade: rollout the upgraded version to all ZooKeeper servers incrementally, one at a time. Monitor your dashboard during the whole rolling upgrade process.</li></ul><ol start="2"><li>Upgrade bookies  </li></ol><ul><li><p>Canary test: test an upgraded version in one or a small set of bookies.</p></li><li><p>Rolling upgrade:  </p><ul><li><p>a. Disable <code>autorecovery</code> with the following command.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly shell"><pre tabindex="0" class="prism-code language-shell codeBlock_23N8 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">bin/bookkeeper shell autorecovery -disable</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div></li></ul><ul><li><p>b. Rollout the upgraded version to all bookies in the cluster after you determine that a version is safe after canary.  </p></li><li><p>c. After you upgrade all bookies, re-enable <code>autorecovery</code> with the following command.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly shell"><pre tabindex="0" class="prism-code language-shell codeBlock_23N8 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">bin/bookkeeper shell autorecovery -enable</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div></li></ul></li></ul><ol start="3"><li>Upgrade brokers</li></ol><ul><li>Canary test: test an upgraded version in one or a small set of brokers.</li><li>Rolling upgrade: rollout the upgraded version to all brokers in the cluster after you determine that a version is safe after canary.</li></ul><ol start="4"><li>Upgrade proxies</li></ol><ul><li>Canary test: test an upgraded version in one or a small set of proxies.</li><li>Rolling upgrade: rollout the upgraded version to all proxies in the cluster after you determine that a version is safe after canary.</li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="upgrade-zookeeper-optional"></a>Upgrade ZooKeeper (optional)<a class="hash-link" href="#upgrade-zookeeper-optional" title="Direct link to heading">#</a></h2><p>While you upgrade ZooKeeper servers, you can do canary test first, and then upgrade all ZooKeeper servers in the cluster.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="canary-test"></a>Canary test<a class="hash-link" href="#canary-test" title="Direct link to heading">#</a></h3><p>You can test an upgraded version in one of ZooKeeper servers before upgrading all ZooKeeper servers in your cluster.</p><p>To upgrade ZooKeeper server to a new version, complete the following steps:</p><ol><li>Stop a ZooKeeper server.</li><li>Upgrade the binary and configuration files.</li><li>Start the ZooKeeper server with the new binary files.</li><li>Use <code>pulsar zookeeper-shell</code> to connect to the newly upgraded ZooKeeper server and run a few commands to verify if it works as expected.</li><li>Run the ZooKeeper server for a few days, observe and make sure the ZooKeeper cluster runs well.</li></ol><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_31ik" id="canary-rollback"></a>Canary rollback<a class="hash-link" href="#canary-rollback" title="Direct link to heading">#</a></h4><p>If issues occur during canary test, you can shut down the problematic ZooKeeper node, revert the binary and configuration, and restart the ZooKeeper with the reverted binary.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="upgrade-all-zookeeper-servers"></a>Upgrade all ZooKeeper servers<a class="hash-link" href="#upgrade-all-zookeeper-servers" title="Direct link to heading">#</a></h3><p>After canary test to upgrade one ZooKeeper in your cluster, you can upgrade all ZooKeeper servers in your cluster. </p><p>You can upgrade all ZooKeeper servers one by one by following steps in canary test.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="upgrade-bookies"></a>Upgrade bookies<a class="hash-link" href="#upgrade-bookies" title="Direct link to heading">#</a></h2><p>While you upgrade bookies, you can do canary test first, and then upgrade all bookies in the cluster.
For more details, you can read Apache BookKeeper <a href="http://bookkeeper.apache.org/docs/latest/admin/upgrade" target="_blank" rel="noopener noreferrer">Upgrade guide</a>.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="canary-test-1"></a>Canary test<a class="hash-link" href="#canary-test-1" title="Direct link to heading">#</a></h3><p>You can test an upgraded version in one or a small set of bookies before upgrading all bookies in your cluster.</p><p>To upgrade bookie to a new version, complete the following steps:</p><ol><li><p>Stop a bookie.</p></li><li><p>Upgrade the binary and configuration files.</p></li><li><p>Start the bookie in <code>ReadOnly</code> mode to verify if the bookie of this new version runs well for read workload.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly shell"><pre tabindex="0" class="prism-code language-shell codeBlock_23N8 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">bin/pulsar bookie --readOnly</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div></li><li><p>When the bookie runs successfully in <code>ReadOnly</code> mode, stop the bookie and restart it in <code>Write/Read</code> mode.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly shell"><pre tabindex="0" class="prism-code language-shell codeBlock_23N8 thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">bin/pulsar bookie</span></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block">
</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div></li><li><p>Observe and make sure the cluster serves both write and read traffic.</p></li></ol><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_31ik" id="canary-rollback-1"></a>Canary rollback<a class="hash-link" href="#canary-rollback-1" title="Direct link to heading">#</a></h4><p>If issues occur during the canary test, you can shut down the problematic bookie node. Other bookies in the cluster replaces this problematic bookie node with autorecovery. </p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="upgrade-all-bookies"></a>Upgrade all bookies<a class="hash-link" href="#upgrade-all-bookies" title="Direct link to heading">#</a></h3><p>After canary test to upgrade some bookies in your cluster, you can upgrade all bookies in your cluster. </p><p>Before upgrading, you have to decide whether to upgrade the whole cluster at once, including downtime and rolling upgrade scenarios.</p><p>In a rolling upgrade scenario, upgrade one bookie at a time. In a downtime upgrade scenario, shut down the entire cluster, upgrade each bookie, and then start the cluster.</p><p>While you upgrade in both scenarios, the procedure is the same for each bookie.</p><ol><li>Stop the bookie. </li><li>Upgrade the software (either new binary or new configuration files).</li><li>Start the bookie.</li></ol><blockquote><p><strong>Advanced operations</strong><br>
When you upgrade a large BookKeeper cluster in a rolling upgrade scenario, upgrading one bookie at a time is slow. If you configure rack-aware or region-aware placement policy, you can upgrade bookies rack by rack or region by region, which speeds up the whole upgrade process.</p></blockquote><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="upgrade-brokers-and-proxies"></a>Upgrade brokers and proxies<a class="hash-link" href="#upgrade-brokers-and-proxies" title="Direct link to heading">#</a></h2><p>The upgrade procedure for brokers and proxies is the same. Brokers and proxies are <code>stateless</code>, so upgrading the two services is easy.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="canary-test-2"></a>Canary test<a class="hash-link" href="#canary-test-2" title="Direct link to heading">#</a></h3><p>You can test an upgraded version in one or a small set of nodes before upgrading all nodes in your cluster.</p><p>To upgrade to a new version, complete the following steps:</p><ol><li>Stop a broker (or proxy).</li><li>Upgrade the binary and configuration file.</li><li>Start a broker (or proxy).</li></ol><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithStickyNavbar_31ik" id="canary-rollback-2"></a>Canary rollback<a class="hash-link" href="#canary-rollback-2" title="Direct link to heading">#</a></h4><p>If issues occur during canary test, you can shut down the problematic broker (or proxy) node. Revert to the old version and restart the broker (or proxy).</p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="upgrade-all-brokers-or-proxies"></a>Upgrade all brokers or proxies<a class="hash-link" href="#upgrade-all-brokers-or-proxies" title="Direct link to heading">#</a></h3><p>After canary test to upgrade some brokers or proxies in your cluster, you can upgrade all brokers or proxies in your cluster. </p><p>Before upgrading, you have to decide whether to upgrade the whole cluster at once, including downtime and rolling upgrade scenarios.</p><p>In a rolling upgrade scenario, you can upgrade one broker or one proxy at a time if the size of the cluster is small. If your cluster is large, you can upgrade brokers or proxies in batches. When you upgrade a batch of brokers or proxies, make sure the remaining brokers and proxies in the cluster have enough capacity to handle the traffic during upgrade.</p><p>In a downtime upgrade scenario, shut down the entire cluster, upgrade each broker or proxy, and then start the cluster.</p><p>While you upgrade in both scenarios, the procedure is the same for each broker or proxy.</p><ol><li>Stop the broker or proxy. </li><li>Upgrade the software (either new binary or new configuration files).</li><li>Start the broker or proxy.</li></ol></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/apache/pulsar/edit/master/site2/website-next/versioned_docs/version-2.7.0/administration-upgrade.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_2_ui" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_13-_"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/2.7.0/administration-proxy"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« Pulsar proxy</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs/2.7.0/security-overview"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Overview Â»</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_35-E thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#upgrade-guidelines" class="table-of-contents__link">Upgrade guidelines</a></li><li><a href="#upgrade-sequence" class="table-of-contents__link">Upgrade sequence</a></li><li><a href="#upgrade-zookeeper-optional" class="table-of-contents__link">Upgrade ZooKeeper (optional)</a><ul><li><a href="#canary-test" class="table-of-contents__link">Canary test</a></li><li><a href="#upgrade-all-zookeeper-servers" class="table-of-contents__link">Upgrade all ZooKeeper servers</a></li></ul></li><li><a href="#upgrade-bookies" class="table-of-contents__link">Upgrade bookies</a><ul><li><a href="#canary-test-1" class="table-of-contents__link">Canary test</a></li><li><a href="#upgrade-all-bookies" class="table-of-contents__link">Upgrade all bookies</a></li></ul></li><li><a href="#upgrade-brokers-and-proxies" class="table-of-contents__link">Upgrade brokers and proxies</a><ul><li><a href="#canary-test-2" class="table-of-contents__link">Canary test</a></li><li><a href="#upgrade-all-brokers-or-proxies" class="table-of-contents__link">Upgrade all brokers or proxies</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="footer__bottom text--center"><div class="footer__copyright">Inc.Copyright Â© 2021 The Apache Software Foundation. All Rights Reserved. Apache, Apache Pulsar and the Apache feather logo are trademarks of The Apache Software Foundation.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.668ae9d7.js"></script>
<script src="/assets/js/main.3d3de418.js"></script>
</body>
</html>