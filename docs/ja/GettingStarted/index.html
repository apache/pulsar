<!DOCTYPE html>
<html>
  <head>
    <script type="text/javascript">
  var shiftWindow = function() { scrollBy(0, -108) };
  window.addEventListener("hashchange", shiftWindow);
  window.addEventListener("pageshow", shiftWindow);
  function load() { if (window.location.hash) shiftWindow(); }
</script>

<title>Pulsar入門</title>

<link rel="stylesheet" href="/incubator-pulsar/css/style.css">
<link rel="shortcut icon" href="/incubator-pulsar/img/favicon.ico">

<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/tether/1.4.0/js/tether.min.js"></script>
<script src="https://code.jquery.com/ui/1.12.1/jquery-ui.min.js"></script>
<script src="/incubator-pulsar/js/jquery.tocify.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.6/js/bootstrap.min.js" integrity="sha384-vBWWzlZJ8ea9aCX4pEW3rVHjgjt7zpkNpZk+02D9phzyeVkE+jo0ieGizqPLForn" crossorigin="anonymous"></script>

<script async src="/incubator-pulsar/js/main.js"></script>

  </head>
  <body class="body">
    <main class="main">
      <header class="container-fluid sticky-top top-nav">
        <nav class="navbar navbar-default navbar-toggleable-xl container">
  <a class="navbar-brand" href="/incubator-pulsar">
    <img src="/incubator-pulsar/img/pulsar-logo.png">
  </a>

  <div class="collapse navbar-collapse justify-content-end" id="nav-content">
    <ul class="nav navbar-nav">
      <li class="nav-item">
        <a class="nav-link" href="/incubator-pulsar/docs">Docs</a>
      </li>
      <li class="nav-item">
        <a class="nav-link" href="/incubator-pulsar/javadoc">Java</a>
      </li>
      <li class="nav-item">
        <a class="nav-link" href="/incubator-pulsar/api/cpp">C++</a>
      </li>
      <li class="nav-item">
        <a class="nav-link" href="/incubator-pulsar/api/python">Python</a>
      </li>
      <li class="nav-item">
        <a class="nav-link" href="/incubator-pulsar/ja"><img class="japan-flag" src="/incubator-pulsar/img/japan-flag.svg"></a>
      </li>
      <li class="nav-item">
        <a class="nav-link" href="https://github.com/yahoo/pulsar"><i class="fa fa-github fa-lg"></i></a>
      </li>
      <li class="nav-item version">
        <a class="nav-link">Pulsar 1.17.5</a>
      </li>
    </ul>

  </div>
</nav>

      </header>

      <main>
        <div class="docs-container container-fluid">
  <div class="row">
    <nav class="sidebar-nav col-sm-3 col-lg-3">
      <ul class="sidebar">
  
  <section class="sidebar-group">
    <h4>Getting started</h4>
    <ul>
      
      
      
      
      <li><a class="active" href="/incubator-pulsar/ja/GettingStarted/"><i class="fa fa-file-text-o"></i>Pulsar入門</a></li>
      
      
      
      
      
      <li><a href="/incubator-pulsar/ja/Architecture/"><i class="fa fa-file-text-o"></i>システム概要</a></li>
      
      
    </ul>
  </section>
  
  <section class="sidebar-group">
    <h4>運用管理</h4>
    <ul>
      
      
      
      
      <li><a href="/incubator-pulsar/ja/ClusterSetup/"><i class="fa fa-file-text-o"></i>クラスタのセットアップ</a></li>
      
      
      
      
      
      <li><a href="/incubator-pulsar/ja/AdminInterface/"><i class="fa fa-file-text-o"></i>adminツールとAPI</a></li>
      
      
    </ul>
  </section>
  
</ul>

    </nav>

    <article class="col-sm-7 col-lg-7">
      <section class="docs-header">
        <h1 class="docs-title">Pulsar入門</h1>
        
        <hr />
      </section>

      <section class="content">
        <h2 id="基本コンセプト">基本コンセプト</h2>

<p>Pulsarはpub-subパラダイムに基づいて構築されたメッセージングシステムです。
<strong>トピック</strong>は<strong>Producer</strong>と<strong>Consumer</strong>を結びつける基本的なリソースです。</p>

<p>Producerはトピックに接続してメッセージを発行する事ができます。
Consumerはトピックを<strong>購読</strong>してメッセージを受信する事ができます。</p>

<p>一度サブスクリプションが作成されると、たとえConsumerが切断された場合でも、
Consumerから処理の成功を通知する<em>*Ack (確認応答) **が返されるまで全てのメッセージは
システムによって</em>保持*されます。</p>

<h3 id="トピック名">トピック名</h3>

<p>トピック名は次のようになります:</p>
<div class="highlighter-rouge"><pre class="highlight"><code>persistent://my-property/us-west/my-namespace/my-topic
</code></pre>
</div>

<p>トピック名の構造は、Pulsarのマルチテナント性に関連しています。
この例では:</p>
<ul>
  <li><code class="highlighter-rouge">persistent</code> →
 全てのメッセージが複数のディスクに永続化されるトピックである事を示します。
 これは現時点でサポートされている唯一のトピック形式です。</li>
  <li><code class="highlighter-rouge">my-property</code> →
 <strong>プロパティ</strong>はPulsarインスタンスにおける<em>テナント</em>を示す識別子です。</li>
  <li><code class="highlighter-rouge">us-west</code> →
 トピックが存在する<strong>クラスタ</strong>です。
 典型的には、地理的地域やデータセンタごとにクラスタが存在する事になります。</li>
  <li><code class="highlighter-rouge">my-namespace</code> →
 <strong>ネームスペース</strong>は管理単位であり、関連するトピックのグループを表します。
 ほとんどの設定はネームスペースレベルで行われます。各プロパティは複数のネームスペースを持つ事が可能です。</li>
  <li><code class="highlighter-rouge">my-topic</code> →
 トピック名の最後の部分です。この部分は自由形式であり、システム上の特別な意味は持ちません。</li>
</ul>

<h3 id="サブスクリプションモード">サブスクリプションモード</h3>

<p>各トピックは複数の<strong>サブスクリプション</strong>を持つ事ができます。
それぞれのサブスクリプションは異なる名前を持ち、またサブスクリプションごとに異なるタイプを指定できます:</p>

<ul>
  <li><strong>Exclusive</strong> →
1つのConsumerだけがこのサブスクリプションに所属する事を許されます。メッセージの順番は保証されます。</li>
  <li><strong>Shared</strong> →
複数のConsumerが同じサブスクリプションに接続し、メッセージは利用可能なConsumerの間でラウンドロビンで配信されます。
メッセージの順番は入れ替わる可能性があります。</li>
  <li><strong>Failover</strong> →
1つのConsumerだけがアクティブにメッセージを受信し、他のConsumerはスタンバイ状態になります。
メッセージの順番は保証されます。</li>
</ul>

<p>詳しい説明は<a href="Architecture.md">アーキテクチャ</a>のページを参照してください。</p>

<h2 id="ソフトウェアの入手">ソフトウェアの入手</h2>

<p>次の場所から最新のバイナリリリースをダウンロードしてください。</p>

<div class="highlighter-rouge"><pre class="highlight"><code>https://github.com/yahoo/pulsar/releases/latest
</code></pre>
</div>

<div class="language-shell highlighter-rouge"><pre class="highlight"><code><span class="gp">$ </span>tar xvfz pulsar-X.Y-bin.tar.gz
<span class="gp">$ </span><span class="nb">cd </span>pulsar-X.Y
</code></pre>
</div>

<h2 id="スタンドアローンなpulsarサーバの起動">スタンドアローンなPulsarサーバの起動</h2>

<p>アプリケーション開発や実際に稼働するサービスの迅速なセットアップのために、
Pulsarのスタンドアローンモードを使用する事ができます。
このモードでは、Broker, ZooKeeper, BookKeeperの3コンポーネントを
単一のJVMプロセスで起動します。</p>

<div class="language-shell highlighter-rouge"><pre class="highlight"><code><span class="gp">$ </span>bin/pulsar standalone
</code></pre>
</div>

<p>Pulsarのサービスはすぐに利用可能となり、<code class="highlighter-rouge">http://localhost:8080/</code>
をサービスのURLとしてクライアントに使用させる事ができます。</p>

<p>サンプルのネームスペース <code class="highlighter-rouge">sample/standalone/ns1</code> が既に利用可能な状態になっています。</p>

<h2 id="pulsarのjavaクライアントapiの使用">PulsarのJavaクライアントAPIの使用</h2>

<p>Pulsarクライアントライブラリの依存関係をインクルードしてください。</p>

<p>最新のバージョンは <a href="https://maven-badges.herokuapp.com/maven-central/com.yahoo.pulsar/pulsar-client"><img src="https://maven-badges.herokuapp.com/maven-central/com.yahoo.pulsar/pulsar-client/badge.svg" alt="Maven Central" /></a> です。</p>

<div class="language-xml highlighter-rouge"><pre class="highlight"><code><span class="nt">&lt;dependency&gt;</span>
  <span class="nt">&lt;groupId&gt;</span>com.yahoo.pulsar<span class="nt">&lt;/groupId&gt;</span>
  <span class="nt">&lt;artifactId&gt;</span>pulsar-client<span class="nt">&lt;/artifactId&gt;</span>
  <span class="nt">&lt;version&gt;</span>${pulsar.version}<span class="nt">&lt;/version&gt;</span>
<span class="nt">&lt;/dependency&gt;</span>
</code></pre>
</div>

<h3 id="consumer">Consumer</h3>

<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="n">PulsarClient</span> <span class="n">client</span> <span class="o">=</span> <span class="n">PulsarClient</span><span class="o">.</span><span class="na">create</span><span class="o">(</span><span class="s">"http://localhost:8080"</span><span class="o">);</span>

<span class="n">Consumer</span> <span class="n">consumer</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="na">subscribe</span><span class="o">(</span>
            <span class="s">"persistent://sample/standalone/ns1/my-topic"</span><span class="o">,</span>
            <span class="s">"my-subscribtion-name"</span><span class="o">);</span>

<span class="k">while</span> <span class="o">(</span><span class="kc">true</span><span class="o">)</span> <span class="o">{</span>
  <span class="c1">// 1つのメッセージを待ち受け</span>
  <span class="n">Message</span> <span class="n">msg</span> <span class="o">=</span> <span class="n">consumer</span><span class="o">.</span><span class="na">receive</span><span class="o">();</span>

  <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Received message: "</span> <span class="o">+</span> <span class="n">msg</span><span class="o">.</span><span class="na">getData</span><span class="o">());</span>

  <span class="c1">// Brokerがメッセージを削除できるようにするためのAck</span>
  <span class="n">consumer</span><span class="o">.</span><span class="na">acknowledge</span><span class="o">(</span><span class="n">msg</span><span class="o">);</span>
<span class="o">}</span>

<span class="n">client</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
</code></pre>
</div>

<h3 id="producer">Producer</h3>

<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="n">PulsarClient</span> <span class="n">client</span> <span class="o">=</span> <span class="n">PulsarClient</span><span class="o">.</span><span class="na">create</span><span class="o">(</span><span class="s">"http://localhost:8080"</span><span class="o">);</span>

<span class="n">Producer</span> <span class="n">producer</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="na">createProducer</span><span class="o">(</span>
            <span class="s">"persistent://sample/standalone/ns1/my-topic"</span><span class="o">);</span>

<span class="c1">// 10のメッセージをトピックに発行</span>
<span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
    <span class="n">producer</span><span class="o">.</span><span class="na">send</span><span class="o">(</span><span class="s">"my-message"</span><span class="o">.</span><span class="na">getBytes</span><span class="o">());</span>
<span class="o">}</span>

<span class="n">client</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
</code></pre>
</div>

      </section>
    </article>

    <nav class="toc-bar col-sm-2 col-lg-2">
      <div id="toc"></div>
    </nav>
  </div>
</div>

      </main>
    </main>

    <footer class="footer">
  <div class="container">
    <p class="text-center">&copy; Apache Foundation 2017</p>
  </div>
</footer>


    
  </body>
</html>
